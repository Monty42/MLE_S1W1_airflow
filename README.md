# –í–µ–±–∏–Ω–∞—Ä "–°–æ–∑–¥–∞–Ω–∏–µ Airflow DAG —Ä–∞–∑–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏"

## –ö—É—Ä—Å "–ò–Ω–∂–µ–Ω–µ—Ä –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è", –Ø–Ω–¥–µ–∫—Å –ü—Ä–∞–∫—Ç–∏–∫—É–º

>### –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ—Å–ª–µ–¥—É–µ—â–µ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤ –º–æ–¥–µ–ª—è—Ö –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

1. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º EDA –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –í—Å–µ–º–∏—Ä–Ω–æ–≥–æ –±–∞–Ω–∫–∞ (World Bank)
2. –†–µ–∞–ª–∏–∑—É–µ–º ETL-–ø–∞–π–ø–ª–∞–π–Ω–∞ —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö
3. –°–æ–∑–¥–∞–¥–∏–º –ø–µ—Ä–≤—ã–π DAG –¥–ª—è –ø–æ–ª—É—á–∏–≤—à–µ–≥–æ—Å—è ETL-–ø–∞–π–ø–ª–∞–π–Ω–∞
4. –ü–æ–ø—Ä–∞–∫—Ç–∏–∫—É–µ–º—Å—è
5. –°–æ–∑–¥–∞–¥–∏–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é DAG

>### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø—Ä–æ–µ–∫—Ç–æ–º?

>#### 1. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

1. –ß—Ç–æ–±—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–¥–µ–ª–∞—Ç—å –µ–≥–æ –∫–æ–ø–∏—é. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –ø–æ –∫–Ω–æ–ø–∫–µ fork.

2. –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ —Å–≤–æ—ë –ª–æ–∫–∞–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (–Ω–æ –ª—É—á—à–µ –≤—Å–µ-—Ç–∞–∫–∏ –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ):

~~~
git clone <–∞–¥—Ä–µ—Å –≤–∞—à–µ–π –∫–æ–ø–∏–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è>
~~~

3. –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –≤–µ—Ç–∫—É:

~~~
git checkout -b <–∏–º—è –Ω–æ–≤–æ–π –≤–µ—Ç–∫–∏>
~~~

4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω—É–∂–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

~~~
python -m venv <–∏–º—è –ø–∞–ø–∫–∏ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è>
source <–∏–º—è –ø–∞–ø–∫–∏ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è>/bin/activate
python -m pip install --upgrade pip
pip install -r requirements.txt
~~~

5. –°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∞–π–ª–∞ `.env_template`. –í—ã –¥–æ–ª–∂–Ω—ã –±—ã–ª–∏ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–µ—Ä–≤—ã—Ö –º–æ–¥—É–ª–µ–π –∫—É—Ä—Å–∞.

6. –ì–æ—Ç–æ–≤–æ! –ú–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏—è.

#### 2. –ó–∞–ø—É—Å—Ç–∏–º –∫–∞–∂–¥—ã–π —ç—Ç–∞–ø –ø–æ –ø–æ—Ä—è–¥–∫—É

> ##### 2.1 –ó–∞–ø—É—Å–∫ ETL-–ø–∞–π–ø–ª–∞–π–Ω–∞

–ù–µ–±–æ–ª—å—à–æ–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∏ –≤—ã–≤–æ–¥—ã –ø–æ —Ä–∞–±–æ—Ç–µ —Å –Ω–∏–º–∏ –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ —Ñ–∞–π–ª–µ `EDA.ipynb`.

ETL-–ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Ñ–∞–π–ª–µ `wb_data_etl.py`.
–î–ª—è –∑–∞–ø—É—Å–∫–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞ –∑–∞–π–¥–∏—Ç–µ –≤ –Ω–æ—É—Ç–±—É–∫ `test.ipynb` -- –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –≤–∞—à–∏—Ö –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö.

–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —è–¥—Ä–∞ Jupyter, –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:

~~~
jupyter notebook
~~~

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—ã–±–µ—Ä–∏—Ç–µ —è–¥—Ä–æ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –Ω–æ—É—Ç–±—É–∫–∞ –∏–ª–∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ.

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —è—á–µ–π–∫–∏ –Ω–æ—É—Ç–±—É–∫–∞.

–ö–æ–≥–¥–∞ –≤—ã –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–≤—É—é —è—á–µ–π–∫—É, –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ—è–≤–∏—Ç—Å—è —Ñ–∞–π–ª `py_log.log`.
–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–π —è—á–µ–π–∫–∏ –¥–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –∑–∞–ø–æ–ª–Ω–∏—Ç—å—Å—è –ª–æ–≥–∞–º–∏. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–µ `OK`

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤–æ—é —Ü–µ–ª–µ–≤—É—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `SQLAlchemy`. –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ —Ñ–∞–π–ª–µ `wb_data_etl.py`

> ##### 2.2 –ó–∞–ø—É—Å–∫ Airflow

–°–∫–∞—á–∞–π—Ç–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑ —Å–µ—Ä–≤–∏—Å–æ–≤ Airflow

~~~
curl -LfO https://airflow.apache.org/docs/apache-airflow/2.7.3/docker-compose.yaml
~~~

–í —Å–∫–∞—á–∞–Ω–Ω–æ–º —Ñ–∞–π–ª–µ `docker-compose.yaml` —Ä–∞—Å–∫–æ–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ 54 —Å—Ç—Ä–æ–∫—É –∏ –∑–∞–∫–æ–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ 53 —Å—Ç—Ä–æ–∫—É –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ:

~~~
53.    # image: ${AIRFLOW_IMAGE_NAME:-apache/airflow:2.7.3}
54.    build: .
~~~

–ï—Å–ª–∏ —É –≤–∞—Å –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –ø–∞–ø–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã Airflow (–≤–Ω—É—Ç—Ä–∏ —Å–∫–∞—á–∞–Ω–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –µ—Å—Ç—å –≤—Å–µ –ø–∞–ø–∫–∏ –∫—Ä–æ–º–µ `./logs`), –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:

~~~
mkdir -p ./dags ./logs ./plugins ./config
~~~

–î–æ–±–∞–≤—å—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∞—à–µ–º `AIRFLOW_UID` –≤ —Ñ–∞–π–ª `.env`

~~~
echo -e "\nAIRFLOW_UID=$(id -u)" >> .env
~~~

–°–ª–µ–¥—É—é—â–∞—è –∫–æ–º–∞–Ω–¥–∞ —Å–æ–∑–¥–∞—Å—Ç —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å —Å –ª–æ–≥–∏–Ω–æ–º –∏ –ø–∞—Ä–æ–ª–µ–º Airflow –¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–π—Å–∞

~~~
docker compose up airflow-init
~~~

–û—Ç—á–∏—Å—Ç–∏–º –≤–æ–∑–º–æ–∂–Ω—ã–π –∫—ç—à, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–ª—Å—è –Ω–∞ –ø—Ä–æ—à–ª–æ–º —à–∞–≥–µ

~~~
docker compose down --volumes --remove-orphans
~~~

–ù–∞—á–Ω–µ–º —Å–±–æ—Ä–∫—É –æ–±—Ä–∞–∑–∞ —Å –≤—Å–µ–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

~~~
docker compose up --build
~~~

- **–õ–æ–≥–∏–Ω**: airflow
- **–ü–∞—Ä–æ–ª—å**: airflow

> ##### 2.3 –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ë–î

–í–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å 3 –î–ë:

1. `source_db` -- –æ–±—â–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
2. `destination_db` -- –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –ë–î, –≤ –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –º–æ–∂–µ—Ç–µ –≤—ã–≥—Ä—É–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
3. `population_db` -- –ª–æ–∫–∞–ª—å–Ω–∞—è SQLite –î–ë, –∫–æ—Ç–æ—Ä—É—é –º—ã —Å –ø–æ–º–æ—â—å—é Dockerfile –ø–æ–ª–æ–∂–∏–ª–∏ –≤ –ø–∞–ø–∫—É `./tmp`

–ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–≤—ã–µ 2 –ë–î –ø–æ–∫–∞–∑–∞–Ω–∞ –≤–Ω—É—Ç—Ä–∏ 1 —Å–ø—Ä–∏–Ω—Ç–∞, –ø–æ—ç—Ç–æ–º—É –º—ã —Ä–∞—Å—Å–∫–∞–∂–µ–º —Ç–æ–ª—å–∫–æ –æ —Ç–æ–º –∫–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é:
![image](/for_readme/population_data.png)

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∞ —Ä–∏—Å—É–Ω–∫–µ. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —É –≤–∞—Å –≤ –º–µ–Ω—é Connections –±—É–¥–µ—Ç –ø–æ–¥–æ–±–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∞:
![image](/for_readme/All_hooks.png)

> ##### 2.4 –ó–∞–ø—É—Å—Ç–∏–º TaskFlow DAG

–ù–∞ –æ–±—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ DAGs –≤—ã –º–æ–∂–µ—Ç–µ —É–≤–∏–¥–∏—Ç—å –ø–æ–¥–≥—Ä—É–∑–∏–≤—à–∏–µ—Å—è –¥–∞–≥–∏:

![image](/for_readme/DAGs.png)

–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞–≥ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º `prepare_wb_data`.
![image](/for_readme/TaskFlow.png)

–í—ã –ø–æ–ø–∞–¥–µ—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É, –≥–¥–µ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —ç—Ç–æ—Ç –¥–∞–≥. –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—ã —É–≤–∏–¥–∏—Ç–µ —á—Ç–æ-—Ç–æ –ø–æ–¥–æ–±–Ω–æ–µ:

![image](/for_readme/TaskFlow_result.png)

–ö–æ–¥ –¥–ª—è —ç—Ç–æ–≥–æ DAG –ª–µ–∂–∏—Ç –≤–Ω—É—Ç—Ä–∏ –ø–∞–ø–∫–∏ `dags`, —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º `wb_data.py`.

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –õ–æ–≥–∏ –∏ –≤—ã—Ö–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É. –ï—Å—Ç—å –ª–∏ —Ç–∞–º –¥–∞–Ω–Ω—ã–µ –∏ –ø–æ—Ö–æ–∂–∏ –ª–∏ –æ–Ω–∏ –Ω–∞ —Ç–æ, —á—Ç–æ –º—ã —É–∂–µ –ø—Ä–æ–¥–µ–ª–∞–ª–∏ –≤ ETL.

> ##### 2.5 –ó–∞–ø—É—Å—Ç–∏–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π DAG

–ù–∞ –æ–±—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ DAGs –≤—ã –º–æ–∂–µ—Ç–µ —É–≤–∏–¥–∏—Ç—å –ø–æ–¥–≥—Ä—É–∑–∏–≤—à–∏–µ—Å—è –¥–∞–≥–∏:

![image](/for_readme/DAGs.png)

–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞–≥ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º `prepare_wb_data_alt`.
![image](/for_readme/WithFlow.png)

–í—ã –ø–æ–ø–∞–¥–µ—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É, –≥–¥–µ –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —ç—Ç–æ—Ç –¥–∞–≥. –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—ã —É–≤–∏–¥–∏—Ç–µ —á—Ç–æ-—Ç–æ –ø–æ–¥–æ–±–Ω–æ–µ:

![image](/for_readme/WithFlow_result.png)

–ö–æ–¥ –¥–ª—è —ç—Ç–æ–≥–æ DAG –ª–µ–∂–∏—Ç –≤–Ω—É—Ç—Ä–∏ –ø–∞–ø–∫–∏ `dags`, —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º `alt_wb_data.py`.

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –õ–æ–≥–∏ –∏ –≤—ã—Ö–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É. –ï—Å—Ç—å –ª–∏ —Ç–∞–º –¥–∞–Ω–Ω—ã–µ –∏ –ø–æ—Ö–æ–∂–∏ –ª–∏ –æ–Ω–∏ –Ω–∞ —Ç–æ, —á—Ç–æ –º—ã —É–∂–µ –ø—Ä–æ–¥–µ–ª–∞–ª–∏ –≤ ETL –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–º DAG.

#### 3. –ó–∞–¥–∞–Ω–∏–µ –¥–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

> ##### 3.1 –ù–∞ –∑–∞–Ω—è—Ç–∏–∏ (–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è +- 20 –º–∏–Ω—É—Ç)

–†–µ–∞–ª–∏–∑–∞—É–µ–º DAG –¥–æ –∫–æ–Ω—Ü–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ —Ä–∞–Ω–µ–µ ETL-–ø–∞–π–ø–ª–∞–π–Ω–∞.

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ airflow –ø–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –æ–ø–∏—Å–∞–Ω–Ω–æ–π –≤—ã—à–µ

2. –ù–∞ –æ—Å–Ω–æ–≤–µ ETL-–ø–∞–π–ø–ª–∞–π–Ω–∞ —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ —Ç–∞—Å–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è (`transform`) –∏ –≤—ã–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö (`load`)

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–∞–ø–π–ª–∞–Ω —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Airflow. –ù–µ –∑–∞–±—É–¥—å—Ç–µ –ø—Ä–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –±—ã—Å—Ç—Ä–µ–µ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å –æ—à–∏–±–∫—É –≤ —Å–ª—É—á–∞–µ –µ–µ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è. –§–∞–π–ª test.ipynb –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –≤–∞–º –æ—Ü–µ–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–∞–π–ø–ª–∞–π–Ω–∞.

4. –ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—Å–∫–∞ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –≤–µ—Å—å –ø–∞–π–ø–ª–∞–π–Ω –º–æ–≥ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è —Å –æ—à–∏–±–∫–æ–π –Ω–µ –±–æ–ª–µ–µ 3 —Ä–∞–∑ (–Ω–µ –∑–∞–±—É–¥—å—Ç–µ –ø—Ä–æ –ø–µ—Ä–∏–æ–¥—ã –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞)

5. –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è DAG –≤ Airflow –∏ —Å–∫—Ä–∏–Ω—à–æ—Ç –≤—ã—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã. –î–æ–±–∞–≤—å—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞ (–∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –∫–∞—Å—Ç–æ–º–Ω—É—é –ø–∞–ø–æ—á–∫—É).

6. –°–¥–µ–ª–∞–π—Ç–µ pull request –≤ master –∏ —Å–∫–∏–Ω—å—Ç–µ –Ω–∞ –Ω–µ–≥–æ —Å—Å—ã–ª–∫—É –≤ —á–∞—Ç.

> ##### 3.2 –í –∫–∞—á–µ—Å—Ç–≤–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏

–í —Ö–æ–¥–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏–º–µ—é—â–∏–π—Å—è DAG:

1. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –≤—ã—Ö–æ–¥–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –¥–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏–∏ –¥–ª—è –Ω–∞—Å–µ–ª–µ–Ω–∏—è –∫–∞–∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∏—á–∏:
    - `s1w1_electricity_access_percent` - —Ç–∞–±–ª–∏—Ü–∞ "–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —ç–ª–µ–∫—Ç—Ä–æ—ç–Ω–µ—Ä–≥–∏–∏ –¥–ª—è –Ω–∞—Å–µ–ª–µ–Ω–∏—è" –≤ –±–∞–∑–µ `source`
    - `s1w1_rural_population_percent` - —Ç–∞–±–ª–∏—Ü–∞ "–∏–∑–º–µ–Ω–µ–Ω–∏—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç–∏" –≤ –±–∞–∑–µ `source`

2. –ü—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ `totalamt` –≤ —á–∏—Å–ª–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö.

3. –ò–∑–º–µ–Ω–∏—Ç–µ —Å—Ö–µ–º—É —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –ø–æ–ª—è–º–∏

4. –ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—Å–∫–∞ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –≤–µ—Å—å –ø–∞–π–ø–ª–∞–π–Ω –º–æ–≥ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è —Å –æ—à–∏–±–∫–æ–π –Ω–µ –±–æ–ª–µ–µ 3 —Ä–∞–∑ (–Ω–µ –∑–∞–±—É–¥—å—Ç–µ –ø—Ä–æ –ø–µ—Ä–∏–æ–¥—ã –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞)

5. –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è DAG –≤ Airflow –∏ —Å–∫—Ä–∏–Ω—à–æ—Ç –≤—ã—Ö–æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã. –î–æ–±–∞–≤—å—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞ (–∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –∫–∞—Å—Ç–æ–º–Ω—É—é –ø–∞–ø–æ—á–∫—É).

6. –°–¥–µ–ª–∞–π—Ç–µ pull request –≤ master –∏ —Å–∫–∏–Ω—å—Ç–µ –Ω–∞ –Ω–µ–≥–æ —Å—Å—ã–ª–∫—É –≤ —á–∞—Ç.

> ##### 3.3 –í –∫–∞—á–µ—Å—Ç–≤–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è

1. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `TelegramOperator` –¥–ª—è –æ–ø–æ–≤–µ—â–µ–Ω–∏–π.
2. –ü–æ–º–µ–Ω—è–π—Ç–µ –±–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã DAG. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `retries`, `retries_delay` –∏–ª–∏ `retry_exponential_backoff`.
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π —á–µ—Ä–µ–∑ —Ä–∞–∑–Ω—ã–µ

#### 4. –®–ø–∞—Ä–≥–∞–ª–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥–∏—Ç–æ–º

1. –î–æ–±–∞–≤–ª—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∏–Ω–¥–µ–∫—Å:

~~~
git add .
~~~

2. –°–æ–∑–¥–∞—ë–º –∫–æ–º–º–∏—Ç:

~~~
git commit -m "–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≥–æ, —á—Ç–æ –±—ã–ª–æ –∏–∑–º–µ–Ω–µ–Ω–æ"
~~~

3. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

~~~
git push
~~~

–ï—Å–ª–∏ –≤—ã –ª–æ–∫–∞–ª—å–Ω–æ —Å–æ–∑–¥–∞–ª–∏ –Ω–æ–≤—É—é –≤–µ—Ç–∫—É, —ç—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ git —Å–∞–º –ø–æ–¥—Å–∫–∞–∂–µ—Ç, –∫–∞–∫ –µ—ë –º–æ–¥–µ—Ä–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –≤–µ—Ç–∫—É. –ú–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å :)

#### 5. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

==============================

    ‚îú‚îÄ‚îÄ README.md 
    ‚îÇ         
    ‚îú‚îÄ‚îÄ data               <- –ü–∞–ø–∫–∞ c –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
    ‚îÇ
    ‚îú‚îÄ‚îÄ notebooks          <- –ù–æ—É—Ç–±—É–∫ —Å —Ä–∞–∑–≤–µ–¥–æ—á–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º –¥–∞–Ω–Ω—ã—Ö
    ‚îÇ
    ‚îú‚îÄ‚îÄ configs            <- –ö–æ–Ω—Ñ–∏–≥–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Airflow
    ‚îÇ
    ‚îú‚îÄ‚îÄ logs               <- –õ–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á Airflow
    ‚îÇ
    ‚îú‚îÄ‚îÄ requirements.txt   <- –§–∞–π–ª —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
    ‚îÇ
    ‚îú‚îÄ‚îÄ dags               <- –ó–¥–µ—Å—å –±—É–¥—É—Ç –ª–µ–∂–∞—Ç—å –≤–∞—à–∏ DAG
    ‚îÇ
    ‚îú‚îÄ‚îÄ plugins   <- –ö–æ–¥ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –æ–Ω–ª–∞–π–Ω-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏
    ‚îÇ   ‚îÇ
    ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ steps 
    ‚îÇ¬†¬†     ‚îú‚îÄ‚îÄ __init__.py    <- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∫–∞–∫ –º–æ–¥—É–ª—è Python  
    ‚îÇ¬†¬†  ¬†¬† ‚îî‚îÄ‚îÄ wb_data.py     <- –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —à–∞–≥–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ DAG
    ‚îÇ
    ‚îú‚îÄ‚îÄ wb_data_etl.py     <- –ö–æ–¥ –∑–∞–ø—É—Å–∫–∞ ETL-–ø–∞–π–ø–ª–∞–π–Ω–∞
    ‚îÇ
    ‚îú‚îÄ‚îÄ .env_template      <- –§–∞–π–ª —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –≤–∞—à–µ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `.env` –∏–ª–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª –∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ –Ω–µ–≥–æ —Å–≤–æ–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.
    ‚îÇ
    ‚îî‚îÄ‚îÄ Dockerfile         <- –ö–æ–¥ –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å Airflow             

-----------------

#### 6. –í —Å–ª—É—á–∞–µ –æ—à–∏–±–æ–∫

–¢–∞–∫ –∫–∞–∫ –æ—à–∏–±–∫–∏ –Ω–µ–∏–∑–±–µ–∂–Ω—ã, –ø—Ä–µ–¥–ª–∞–≥–∞—é –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:

1. –ü–æ–≥—É–≥–ª–∏—Ç–µ, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –∫—Ç–æ-—Ç–æ —É–∂–µ –ø—ã—Ç–∞–ª—Å—è —ç—Ç–æ —Ä–µ—à–∏—Ç—å.

2. –ï—Å–ª–∏ –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç–µ, —á—Ç–æ –Ω–∞–≥—É–≥–ª–∏–ª–∏, –∏–ª–∏ –Ω–µ –Ω–∞–≥—É–≥–ª–∏–ª–∏ –≤–æ–≤—Å–µ, –ø—Ä–µ–¥–ª–∞–≥–∞—é 2 –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞:

    - —Å–æ–∑–¥–∞—Ç—å —Ç–µ–º—É —Å –æ–±—Å—É–∂–¥–µ–Ω–∏–µ–º –Ω–∞ GitHub –∏ –ø—Ä–∏–ª–æ–∂–∏—Ç—å —Å–≤–æ—é –æ—à–∏–±–∫—É, –º—ã –ø–æ—Å—Ç–∞—Ä–∞–µ–º—Å—è –≤–∞–º –ø–æ–º–æ—á—å.
    - –°–æ–∑–¥–∞–π—Ç–µ PullRequest –≤ `main` –∏ –≤–Ω—É—Ç—Ä–∏ –æ–ø–∏—Å–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞–ø–∏—à–∏—Ç–µ —Å–≤–æ—é –æ—à–∏–±–∫—É, —Ç–æ–≥–¥–∞ –º—ã —Å–º–æ–∂–µ–º –ø–æ–º–æ—á—å –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–µ–µ

> ## –ú—ã –±—É–¥–µ–º —Ä–∞–¥—ã, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–π –∫–æ–¥ –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –ø–æ–ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å —Å–≤–æ–∏ –Ω–∞–≤—ã–∫–∏ –≤ —Ä–∞–±–æ—Ç–µ —Å AirFlow –∏ –∑–∞–ø—É—Å–∫–æ–º —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ ü•∏
